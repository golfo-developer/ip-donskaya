<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöó –ê–≤—Ç–æ–ø–∞—Ä–∫ - –°–∏—Å—Ç–µ–º–∞ —É—á—ë—Ç–∞</title>
    <link rel="stylesheet" href="styles.css">
    
    <!-- Google Sheets API -->
    <script src="https://apis.google.com/js/api.js"></script>
</head>
<body>
    <!-- –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-content">
            <div class="car-animation">üöóüí®</div>
            <h2>–ó–∞–≥—Ä—É–∑–∫–∞...</h2>
        </div>
    </div>

    <!-- –≠–∫—Ä–∞–Ω –≤—Ö–æ–¥–∞ -->
    <div id="login-screen" class="screen" style="display: none;">
        <div class="login-container">
            <div class="login-card">
                <div class="logo">
                    <span class="logo-icon">üöó</span>
                    <h1>–ê–≤—Ç–æ–ø–∞—Ä–∫</h1>
                </div>
                <p class="subtitle">–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–≤—Ç–æ–º–æ–±–∏–ª—è–º–∏</p>
                <button id="vk-login-btn" class="btn btn-primary btn-large">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M13.162 18.994c.609 0 .858-.406.851-.915-.031-1.917.714-2.949 2.059-1.604 1.488 1.488 1.796 2.519 3.603 2.519h3.2c.808 0 1.126-.26 1.126-.668 0-.863-1.421-2.386-2.625-3.504-1.686-1.565-1.765-1.602-.313-3.486 1.801-2.339 4.157-5.336 2.073-5.336h-3.981c-.772 0-.828.435-1.103 1.083-.995 2.347-2.886 5.387-3.604 4.922-.751-.485-.407-2.406-.35-5.261.015-.754.011-1.271-1.141-1.539-.629-.145-1.241-.205-1.809-.205-2.273 0-3.841.953-2.95 1.119 1.571.293 1.42 3.692 1.054 5.16-.638 2.556-3.036-2.024-4.035-4.305-.241-.548-.315-.974-1.175-.974h-3.255c-.492 0-.787.16-.787.516 0 .602 2.96 6.72 5.786 9.77 2.756 2.975 5.48 2.708 7.376 2.708z"/>
                    </svg>
                    –í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ VK
                </button>
                <button id="test-login-btn" class="btn btn-ghost btn-large" style="margin-top: 12px;">
                    üß™ –í–æ–π—Ç–∏ –≤ –¥–µ–º–æ-—Ä–µ–∂–∏–º–µ
                </button>
                <p style="color: var(--text-muted); font-size: 13px; margin-top: 12px;">
                    –î–µ–º–æ-—Ä–µ–∂–∏–º –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑ VK
                </p>
                <div class="features">
                    <div class="feature">‚úì –£—á—ë—Ç –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π</div>
                    <div class="feature">‚úì –ò—Å—Ç–æ—Ä–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</div>
                    <div class="feature">‚úì –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –æ—Ç—á—ë—Ç—ã</div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ -->
    <div id="app-screen" class="screen" style="display: none;">
        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
        <nav class="navbar">
            <div class="nav-content">
                <div class="nav-left">
                    <span class="nav-logo">üöó –ê–≤—Ç–æ–ø–∞—Ä–∫</span>
                </div>
                <div class="nav-right">
                    <span id="user-name" class="user-name"></span>
                    <span id="user-role" class="user-role badge"></span>
                    <button id="logout-btn" class="btn btn-ghost btn-small">–í—ã—Ö–æ–¥</button>
                </div>
            </div>
        </nav>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <div class="main-content">
            <!-- –ë–æ–∫–æ–≤–æ–µ –º–µ–Ω—é -->
            <aside class="sidebar">
                <div class="menu">
                    <button class="menu-item active" data-page="dashboard">
                        <span class="menu-icon">üìä</span>
                        <span class="menu-text">–ì–ª–∞–≤–Ω–∞—è</span>
                    </button>
                    <button class="menu-item" data-page="my-cars">
                        <span class="menu-icon">üöò</span>
                        <span class="menu-text">–ú–æ–∏ –∞–≤—Ç–æ</span>
                    </button>
                    <button class="menu-item" data-page="take-car">
                        <span class="menu-icon">üîë</span>
                        <span class="menu-text">–í–∑—è—Ç—å –∞–≤—Ç–æ</span>
                    </button>
                    <button class="menu-item mechanic-only" data-page="maintenance" style="display: none;">
                        <span class="menu-icon">üîß</span>
                        <span class="menu-text">–û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ</span>
                    </button>
                    <button class="menu-item admin-only" data-page="admin" style="display: none;">
                        <span class="menu-icon">üë•</span>
                        <span class="menu-text">–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</span>
                    </button>
                    <button class="menu-item admin-viewer-only" data-page="stats" style="display: none;">
                        <span class="menu-icon">üìà</span>
                        <span class="menu-text">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</span>
                    </button>
                </div>
            </aside>

            <!-- –°—Ç—Ä–∞–Ω–∏—Ü—ã -->
            <main class="page-content">
                <!-- –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
                <div id="page-dashboard" class="page active">
                    <h2 class="page-title">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! üëã</h2>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon">üöó</div>
                            <div class="stat-value" id="stat-total-cars">0</div>
                            <div class="stat-label">–í—Å–µ–≥–æ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">‚úÖ</div>
                            <div class="stat-value" id="stat-available-cars">0</div>
                            <div class="stat-label">–î–æ—Å—Ç—É–ø–Ω–æ</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üîÑ</div>
                            <div class="stat-value" id="stat-in-use-cars">0</div>
                            <div class="stat-label">–í –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üîß</div>
                            <div class="stat-value" id="stat-maintenance-cars">0</div>
                            <div class="stat-label">–ù–∞ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–∏</div>
                        </div>
                    </div>

                    <div class="recent-activity">
                        <h3>–ù–µ–¥–∞–≤–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</h3>
                        <div id="recent-logs" class="activity-list"></div>
                    </div>
                </div>

                <!-- –ú–æ–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏ -->
                <div id="page-my-cars" class="page">
                    <h2 class="page-title">–ú–æ–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏ üöò</h2>
                    <div id="my-cars-list" class="cars-grid"></div>
                </div>

                <!-- –í–∑—è—Ç—å –∞–≤—Ç–æ–º–æ–±–∏–ª—å -->
                <div id="page-take-car" class="page">
                    <h2 class="page-title">–í–∑—è—Ç—å –∞–≤—Ç–æ–º–æ–±–∏–ª—å üîë</h2>
                    
                    <div class="available-cars">
                        <h3>–î–æ—Å—Ç—É–ø–Ω—ã–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏</h3>
                        <div id="available-cars-list" class="cars-grid"></div>
                    </div>

                    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –≤–∑—è—Ç–∏—è –∞–≤—Ç–æ -->
                    <div id="take-car-modal" class="modal" style="display: none;">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3>–í–∑—è—Ç—å –∞–≤—Ç–æ–º–æ–±–∏–ª—å</h3>
                                <button class="modal-close">&times;</button>
                            </div>
                            <div class="modal-body">
                                <div id="selected-car-info"></div>
                                
                                <div class="form-group">
                                    <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–µ–Ω–∑–∏–Ω–∞ (–ª–∏—Ç—Ä—ã)</label>
                                    <input type="number" id="fuel-level" class="form-control" min="0" max="100" required>
                                </div>

                                <div class="form-group">
                                    <label>–°–æ—Å—Ç–æ—è–Ω–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—è</label>
                                    <div class="radio-group">
                                        <label class="radio-label">
                                            <input type="radio" name="car-condition" value="ok" checked>
                                            <span>‚úÖ –¶–µ–ª–æ–µ</span>
                                        </label>
                                        <label class="radio-label">
                                            <input type="radio" name="car-condition" value="broken">
                                            <span>‚ùå –ü–æ–ª–æ–º–∞–Ω–Ω–æ–µ</span>
                                        </label>
                                    </div>
                                </div>

                                <div id="broken-car-fields" class="form-group" style="display: none;">
                                    <label>–û—Ü–µ–Ω–æ—á–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å —Ä–µ–º–æ–Ω—Ç–∞ (‚ÇΩ)</label>
                                    <input type="number" id="repair-cost" class="form-control" min="0">
                                    
                                    <label>–û–ø–∏—Å–∞–Ω–∏–µ –ø–æ–ª–æ–º–∫–∏</label>
                                    <textarea id="damage-description" class="form-control" rows="3"></textarea>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button id="cancel-take-car" class="btn btn-ghost">–û—Ç–º–µ–Ω–∞</button>
                                <button id="confirm-take-car" class="btn btn-primary">–í–∑—è—Ç—å –∞–≤—Ç–æ–º–æ–±–∏–ª—å</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ (–¥–ª—è –º–µ—Ö–∞–Ω–∏–∫–æ–≤) -->
                <div id="page-maintenance" class="page">
                    <h2 class="page-title">–û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ üîß</h2>
                    <div id="maintenance-cars-list" class="cars-grid"></div>

                    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è -->
                    <div id="maintenance-modal" class="modal" style="display: none;">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3>–û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—è</h3>
                                <button class="modal-close">&times;</button>
                            </div>
                            <div class="modal-body">
                                <div id="maintenance-car-info"></div>
                                
                                <div class="form-group">
                                    <label>–ë–µ–Ω–∑–∏–Ω –î–û –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è (–ª)</label>
                                    <input type="number" id="fuel-before" class="form-control" min="0" max="100">
                                </div>

                                <div class="form-group">
                                    <label>–ë–µ–Ω–∑–∏–Ω –ü–û–°–õ–ï –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è (–ª)</label>
                                    <input type="number" id="fuel-after" class="form-control" min="0" max="100">
                                </div>

                                <div class="form-group">
                                    <label>–°–æ—Å—Ç–æ—è–Ω–∏–µ</label>
                                    <div class="radio-group">
                                        <label class="radio-label">
                                            <input type="radio" name="was-broken" value="no" checked>
                                            <span>–ù–µ –±—ã–ª–æ –ø–æ–ª–æ–º–æ–∫</span>
                                        </label>
                                        <label class="radio-label">
                                            <input type="radio" name="was-broken" value="yes">
                                            <span>–ë—ã–ª–∞ –ø–æ–ª–æ–º–∫–∞</span>
                                        </label>
                                    </div>
                                </div>

                                <div id="repair-fields" style="display: none;">
                                    <div class="form-group">
                                        <label>–ü–æ—á–∏–Ω–∏–ª?</label>
                                        <div class="radio-group">
                                            <label class="radio-label">
                                                <input type="radio" name="repaired" value="yes" checked>
                                                <span>‚úÖ –î–∞</span>
                                            </label>
                                            <label class="radio-label">
                                                <input type="radio" name="repaired" value="no">
                                                <span>‚ùå –ù–µ—Ç</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label>–ü—Ä–∏–º–µ—á–∞–Ω–∏—è</label>
                                    <textarea id="maintenance-notes" class="form-control" rows="3"></textarea>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button id="cancel-maintenance" class="btn btn-ghost">–û—Ç–º–µ–Ω–∞</button>
                                <button id="confirm-maintenance" class="btn btn-primary">–ó–∞–≤–µ—Ä—à–∏—Ç—å –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å -->
                <div id="page-admin" class="page">
                    <h2 class="page-title">–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å üë•</h2>
                    
                    <div class="admin-tabs">
                        <button class="tab-btn active" data-tab="users">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</button>
                        <button class="tab-btn" data-tab="cars-admin">–ê–≤—Ç–æ–º–æ–±–∏–ª–∏</button>
                        <button class="tab-btn" data-tab="penalties">–í–∑—ã—Å–∫–∞–Ω–∏—è</button>
                    </div>

                    <!-- –í–∫–ª–∞–¥–∫–∞: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ -->
                    <div id="tab-users" class="tab-content active">
                        <div class="admin-section">
                            <div class="section-header">
                                <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h3>
                            </div>
                            <div id="users-list" class="table-container"></div>
                        </div>
                    </div>

                    <!-- –í–∫–ª–∞–¥–∫–∞: –ê–≤—Ç–æ–º–æ–±–∏–ª–∏ -->
                    <div id="tab-cars-admin" class="tab-content">
                        <div class="admin-section">
                            <div class="section-header">
                                <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—è–º–∏</h3>
                                <button id="add-car-btn" class="btn btn-primary">+ –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ</button>
                            </div>
                            <div id="admin-cars-list" class="table-container"></div>
                        </div>
                    </div>

                    <!-- –í–∫–ª–∞–¥–∫–∞: –í–∑—ã—Å–∫–∞–Ω–∏—è -->
                    <div id="tab-penalties" class="tab-content">
                        <div class="admin-section">
                            <div class="section-header">
                                <h3>–í–∑—ã—Å–∫–∞–Ω–∏—è</h3>
                                <button id="add-penalty-btn" class="btn btn-warning">+ –í—ã–¥–∞—Ç—å –≤–∑—ã—Å–∫–∞–Ω–∏–µ</button>
                            </div>
                            <div id="penalties-list" class="table-container"></div>
                        </div>
                    </div>

                    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–æ–ª–∏ -->
                    <div id="role-modal" class="modal" style="display: none;">
                        <div class="modal-content modal-small">
                            <div class="modal-header">
                                <h3>–ò–∑–º–µ–Ω–∏—Ç—å —Ä–æ–ª—å</h3>
                                <button class="modal-close">&times;</button>
                            </div>
                            <div class="modal-body">
                                <div class="form-group">
                                    <label>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</label>
                                    <p id="role-change-user"></p>
                                </div>
                                <div class="form-group">
                                    <label>–ù–æ–≤–∞—è —Ä–æ–ª—å</label>
                                    <select id="new-role" class="form-control">
                                        <option value="driver">–í–æ–¥–∏—Ç–µ–ª—å</option>
                                        <option value="mechanic">–ú–µ—Ö–∞–Ω–∏–∫</option>
                                        <option value="viewer">–ù–∞–±–ª—é–¥–∞—Ç–µ–ª—å</option>
                                        <option value="admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
                                    </select>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button id="cancel-role-change" class="btn btn-ghost">–û—Ç–º–µ–Ω–∞</button>
                                <button id="confirm-role-change" class="btn btn-primary">–ò–∑–º–µ–Ω–∏—Ç—å</button>
                            </div>
                        </div>
                    </div>

                    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤–∑—ã—Å–∫–∞–Ω–∏—è -->
                    <div id="penalty-modal" class="modal" style="display: none;">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3>–í—ã–¥–∞—Ç—å –≤–∑—ã—Å–∫–∞–Ω–∏–µ</h3>
                                <button class="modal-close">&times;</button>
                            </div>
                            <div class="modal-body">
                                <div class="form-group">
                                    <label>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (VK ID)</label>
                                    <input type="text" id="penalty-user-id" class="form-control" placeholder="–í–≤–µ–¥–∏—Ç–µ VK ID">
                                </div>
                                <div class="form-group">
                                    <label>–ê–≤—Ç–æ–º–æ–±–∏–ª—å (ID)</label>
                                    <input type="text" id="penalty-car-id" class="form-control" placeholder="–í–≤–µ–¥–∏—Ç–µ ID –∞–≤—Ç–æ">
                                </div>
                                <div class="form-group">
                                    <label>–ü—Ä–∏—á–∏–Ω–∞</label>
                                    <textarea id="penalty-reason" class="form-control" rows="3" required></textarea>
                                </div>
                                <div class="form-group">
                                    <label>–°—É–º–º–∞ (‚ÇΩ)</label>
                                    <input type="number" id="penalty-amount" class="form-control" min="0">
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button id="cancel-penalty" class="btn btn-ghost">–û—Ç–º–µ–Ω–∞</button>
                                <button id="confirm-penalty" class="btn btn-warning">–í—ã–¥–∞—Ç—å</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
                <div id="page-stats" class="page">
                    <h2 class="page-title">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ üìà</h2>
                    
                    <div class="stats-tabs">
                        <button class="tab-btn active" data-tab="logs">–í—Å–µ –ª–æ–≥–∏</button>
                        <button class="tab-btn" data-tab="car-stats">–ü–æ –∞–≤—Ç–æ–º–æ–±–∏–ª—è–º</button>
                        <button class="tab-btn" data-tab="user-stats">–ü–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º</button>
                    </div>

                    <div id="tab-logs" class="tab-content active">
                        <div id="all-logs" class="logs-container"></div>
                    </div>

                    <div id="tab-car-stats" class="tab-content">
                        <div id="car-stats-content"></div>
                    </div>

                    <div id="tab-user-stats" class="tab-content">
                        <div id="user-stats-content"></div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
    <div id="notifications-container" class="notifications-container"></div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç -->
    <script src="app.js"></script>
</body>
</html>